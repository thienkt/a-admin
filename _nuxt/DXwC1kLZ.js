import{g as d,A as K,$ as g,L as k,aU as W,aG as Y,q as J,aw as Q,aY as X,a1 as Z,ap as U,az as N,b5 as q,a4 as m,k as p,b6 as ee,b7 as te,ak as ae,F as z,aA as re,D as le,H as ne,aM as ue,v as se,b8 as ie}from"./CL9fQ8rX.js";function T(e,t,a,r){const l=K(),n=d(()=>{const o=t[e];return l!=null&&l.vnode.props?e in l.vnode.props&&l.vnode.props[e]!==void 0:o!==void 0});if(r===void 0)return[d({set(o){a(`update:${e}`,o)},get(){return t[e]}})];const i=t[e],u=g(i===void 0?r:i);return k(()=>t[e],o=>{o!==void 0&&(u.value=o)}),[d({set(o){u.value=o,a(`update:${e}`,o)},get(){return n.value?t[e]:u.value}})]}const oe=e=>typeof e=="object"&&"_setter"in e,de=(e,t)=>{if(!oe(e))return;const a=e._setter;e._setter=r=>{t(r),a(r)}},D=e=>typeof e=="string",ce=Symbol("FormService"),fe=e=>{const t=W(ce,null);if(!t)return{forceDirty:g(!1),forceHideErrorMessages:g(!1),forceHideErrors:g(!1),forceHideLoading:g(!1),fields:d(()=>[]),registerField:()=>{},unregisterField:()=>{},immediate:d(()=>!1)};const a=Y();return J(()=>{t.registerField(a,e)}),Q(()=>{t.unregisterField(a)}),t},$=(e=[],t=null)=>(D(e)&&(e=[e]),e.map(a=>N(a)?a(t):a)),ve={name:{type:String,default:void 0},rules:{type:Array,default:()=>[]},dirty:{type:Boolean,default:!1},error:{type:Boolean,default:void 0},errorMessages:{type:[Array,String],default:void 0},errorCount:{type:[String,Number],default:1},success:{type:Boolean,default:!1},messages:{type:[Array,String],default:()=>[]},immediateValidation:{type:Boolean,default:!1},modelValue:{}},ye=["update:error","update:errorMessages","update:dirty"],_=e=>typeof e=="object"&&typeof e.then=="function",me=(e,t,a)=>{const r=g(t.dirty||!1);return de(e,()=>{r.value=!0,a("update:dirty",!0)}),k(e,(l,n)=>{l===n&&(r.value=!0)},{deep:!0}),k(()=>t.dirty,l=>{r.value!==l&&(r.value=l)}),{isDirty:r}},ge=()=>{const e=g(!1);return{isTouched:e,onBlur:()=>{e.value=!0}}},Ve=e=>{let t=!0;return(...a)=>{if(!t)return;t=!1;const r=e(...a);return U(()=>{t=!0}),r}},he=(e,t,a)=>{const{reset:r,focus:l}=a,[n]=T("error",e,t,!1),[i]=T("errorMessages",e,t,[]),u=g(!1),{isTouched:o,onBlur:x}=ge(),L=d(()=>({"aria-invalid":n.value,"aria-errormessage":typeof i.value=="string"?i.value:i.value.join(", ")})),C=()=>{i.value=[],n.value=!1,h.value=!1,o.value=!1,u.value=!1},b=c=>{let v=!1,s=[];return c.forEach(f=>{D(f)?(s=[...s,f],v=!0):f===!1&&(v=!0)}),i.value=s,n.value=v,!v},M=async()=>{if(!e.rules||!e.rules.length)return!0;const c=$(e.rules.flat(),a.value.value),v=c.filter(f=>_(f)),s=c.filter(f=>!_(f));return v.length?(u.value=!0,Promise.all(v).then(f=>b([...s,...f])).finally(()=>{u.value=!1})):b(s)},V=Ve(()=>{if(!e.rules||!e.rules.length)return!0;const c=e.rules.flat(),v=$(c,a.value.value),s=v.filter(y=>_(y)),f=v.filter(y=>!_(y)),H=f.some(y=>D(y)?y:y===!1);return s.length&&!H?(u.value=!0,Promise.all(s).then(y=>{b([...f,...y]),u.value=!1}),H):b(f)});X(()=>V());const{isDirty:h}=me(a.value,e,t),{forceHideErrors:B,forceHideLoading:R,forceHideErrorMessages:O,forceDirty:E,immediate:j}=fe({isTouched:o,isDirty:h,isValid:d(()=>!n.value),isLoading:u,errorMessages:i,validate:V,validateAsync:M,resetValidation:C,focus:l,reset:()=>{r(),C(),V()},value:d(()=>a.value||e.modelValue),name:Z(e,"name")}),F=d(()=>e.immediateValidation||j.value);let S=!0;const A=c=>{S=!1,c(),U(()=>{S=!0})};return k(a.value,()=>{if(S)return V()},{immediate:F.value}),{isDirty:h,isValid:d(()=>!n.value),isError:n,isTouched:o,isLoading:d({get:()=>B.value?!1:F.value||o.value||h.value||E.value?u.value:!1,set(c){u.value=c}}),computedError:d(()=>B.value?!1:F.value||o.value||h.value||E.value?n.value:!1),computedErrorMessages:d(()=>O.value?[]:i.value),listeners:{onBlur:x},validate:V,resetValidation:C,withoutValidation:A,validationAriaAttributes:L}},P=(e,t)=>{if(!e)return null;if(!("type"in e)||e.type===ee||typeof e=="string")return m("div",t,e);if(e.type===q)return e;if("$el"in e)return P(e.$el,t);if(e.type===te)return m(e.ssContent,t);if(e.type===ae){if(e.children===null)return e;const a=P(e.children[0],t);return a&&(e.children[0]=m(a,t)),e}if(e.type===z)return e.children===null?e:e.children.length===1?m(z,e.props,[P(e.children[0],t)]):m("div",t,e);if(typeof e.type.render=="function"){const a=m(e,t);if(Array.isArray(a.children)&&a.children.length>1)return m("div",t,a.children)}return m(e,t)},Pe=(e,t={},a={})=>{const r=e==null?void 0:e(t);if(!r)return null;const l=r.filter(n=>n.type!==q);return l.length===0?null:l.length===1?P(l[0],a):m("div",{...a,class:p([a.class,"va-headless-wrapper"])},r)},Be=(e,t={},a={})=>{const r=e==null?void 0:e(t);return r?r.map(l=>P(l,a)):null};function G(e){switch(!0){case Array.isArray(e):return e.reduce((t,a)=>({...t,[a]:null}),{});case(typeof e=="object"&&e!==null):return e;default:return{}}}function w(e,t,a="props"){const{mixins:r,extends:l}=t;l&&w(e,l,a),r&&r.forEach(i=>w(e,i,a));const n=G(t[a]);for(const i in n)e[i]=n[i]}function be(e){return e.options?e.options:e.__vccOpts||e.__b?{...e.__vccOpts,...e.__b}:e}function Se(e,t="props"){const a=e.mixins??[],r=e.extends??[],l={};w(l,r,t);for(let n=0;n<a.length;n++)w(l,a[n],t);return Object.assign(l,G(e[t])),l}const Ce=e=>Se(be(e));function Ae(e,t){const a=Ce(e);return t?Object.keys(a).reduce((r,l)=>(t.includes(l)||a[l]===void 0||(r[l]=typeof a[l]=="string"?{}:a[l]),r),{}):a}const _e=e=>{const{props:t}=K();return d(()=>Object.keys(e).reduce((a,r)=>(a[r]=t[r],a),{}))},ke={...le,...re,...ve,arrayValue:{type:[String,Boolean,Object,Number],default:null},label:{type:String,default:""},leftLabel:{type:Boolean,default:!1},trueValue:{type:null,default:!0},falseValue:{type:null,default:!1},indeterminate:{type:Boolean,default:!1},indeterminateValue:{type:null,default:null},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},we=[...ye,"update:modelValue","focus","blur"],Ee=e=>{const t=[e.falseValue,e.trueValue];if(e.indeterminate&&t.push(e.indeterminateValue),new Set(t).size!==t.length)throw new Error("falseValue, trueValue, indeterminateValue props should have strictly different values, which is not the case.")},xe=(e,t,{input:a,label:r,container:l})=>{Ee(e);const n=()=>b(()=>{t("update:modelValue",!1),M()}),i=()=>{var s;(s=se(a.value))==null||s.focus()},{valueComputed:u}=ne(e,t),{computedError:o,computedErrorMessages:x,validationAriaAttributes:L,listeners:C,withoutValidation:b,resetValidation:M,isDirty:V,isTouched:h,isError:B,isLoading:R,isValid:O}=he(e,t,{reset:n,focus:i,value:u}),{isFocused:E}=ue(),j=s=>{t("blur",s),E.value=!1,C.onBlur()},F=s=>{E.value=!0,t("focus",s)},S=d(()=>e.indeterminate&&u.value===e.indeterminateValue),A=d(()=>e.arrayValue!==void 0&&e.arrayValue!==null),c=d(()=>{var s;return A.value?(s=e.modelValue)==null?void 0:s.includes(e.arrayValue):u.value===e.trueValue});return{isDirty:V,isTouched:h,isError:B,isLoading:R,isValid:O,isChecked:c,isIndeterminate:S,onBlur:j,onFocus:F,toggleSelection:()=>{if(!(e.readonly||e.disabled||e.loading)){if(A.value){e.modelValue?Array.isArray(e.modelValue)?e.modelValue.includes(e.arrayValue)?t("update:modelValue",e.modelValue.filter(s=>s!==e.arrayValue)):t("update:modelValue",e.modelValue.concat(e.arrayValue)):t("update:modelValue",e.modelValue===e.arrayValue?[]:[e.modelValue,e.arrayValue]):t("update:modelValue",[e.arrayValue]);return}if(e.indeterminate){S.value?u.value=e.trueValue:c.value?u.value=e.falseValue:u.value=e.indeterminateValue;return}c.value?u.value=e.falseValue:u.value=e.trueValue}},reset:n,focus:i,computedError:o,computedErrorMessages:x,validationAriaAttributes:L}};var I;function Le(){const e=g(!1);let t=!1;return{hasKeyboardFocus:e,keyboardFocusListeners:{mousedown:()=>{t=!0},focus:()=>{t||(e.value=!0),t=!1},blur:()=>{e.value=!1,t=!1}}}}(I=ie())==null||I.addEventListener("mousedown",()=>{setTimeout(()=>{},300)});export{ce as F,ve as a,he as b,fe as c,Pe as d,Ae as e,_e as f,T as g,we as h,ke as i,xe as j,Le as k,Be as r,ye as u};
